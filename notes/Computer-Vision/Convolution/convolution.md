【比啃书效果好多了！复旦大学邱锡鹏教授的《神经网络与深度学习》终于出视频教程了！！草履虫都能看懂！】 https://www.bilibili.com/video/BV1P3411u7c1/?p=36&share_source=copy_web&vd_source=975386ba054f2685c1a99769524e2403



# Convolution

## Background

卷积在许多不同的领域和场景中有广泛的应用，特别是在信号处理、图像处理和深度学习中。它经常用于设计和应用**滤波器**，其目的是对输入信号进行处理，以提取重要特征或去除不需要的噪声。下面是一些卷积的典型应用背景：

### 信号处理中的滤波器

卷积在信号处理中的一个主要用途是设计和应用滤波器。滤波器的作用是对信号进行操作，如消除噪声、提取特定频率或平滑信号。卷积在这类滤波操作中起着核心作用。

- **低通滤波器（Low-Pass Filter, LPF）**：允许低频信号通过，滤除高频成分，从而平滑信号或消除噪声。
- **高通滤波器（High-Pass Filter, HPF）**：允许高频信号通过，滤除低频成分，通常用于边缘检测或提高信号中的细节。
- **带通滤波器（Band-Pass Filter）**：只允许一定频率范围内的信号通过，滤除超出该范围的其他频率。

举例：

- 在音频处理领域，卷积滤波器可以用来减少录音中的噪声或增强某些音频频率。
- 在通信系统中，滤波器通过卷积消除通信信号中的干扰或不需要的频率成分。

### 图像处理
卷积在图像处理中扮演了至关重要的角色，尤其在**边缘检测**、**模糊处理**、**锐化**等方面。通过应用卷积滤波器，可以提取出图像中的关键特征，或对图像进行某种增强或抑制。

- **边缘检测**：通过高通滤波器（如 Sobel、Laplacian 卷积核），可以识别图像中亮度急剧变化的区域，这些区域通常是图像的边缘。边缘检测广泛用于图像识别、目标检测等任务。
  
  - **Sobel算子**（用于检测水平和垂直边缘）：
    
    - 水平边缘检测核
    
    $$
    \begin{bmatrix}
    -1 & 0 & 1 \\
    -2 & 0 & 2 \\
    -1 & 0 & 1
    \end{bmatrix}
    $$
    
    - 垂直边缘检测核
    
    $$
    \begin{bmatrix}
    -1 & -2 & -1 \\
    0 & 0 & 0 \\
    1 & 2 & 1
    \end{bmatrix}
    $$

- **模糊滤波器（Blurring Filter）**：卷积核可以用于图像模糊处理，常用于减少图像中的噪声或平滑图像，模糊滤波器通常是低通滤波器。
  
  - **均值滤波器（Mean Filter）**：
    $$
    \frac{1}{9}
    \begin{bmatrix}
    1 & 1 & 1 \\
    1 & 1 & 1 \\
    1 & 1 & 1
    \end{bmatrix}
    $$
    这种滤波器会将图像中的每个像素与其邻域平均化，从而降低图像的锐度和细节。

- **锐化滤波器（Sharpening Filter）**：通过增强图像的边缘信息，使得图像中的细节更加清晰。

  - **锐化卷积核**：
    $$
    \begin{bmatrix}
    0 & -1 & 0 \\
    -1 & 5 & -1 \\
    0 & -1 & 0
    \end{bmatrix}
    $$

举例：

- 在医学成像中，边缘检测有助于识别病变组织或器官的轮廓。
- 在计算机视觉中，模糊滤波用于减少噪声、提高后续处理（如对象识别或分类）的准确性。

### CNN
在机器学习特别是深度学习领域，卷积神经网络（CNN）广泛用于**图像分类**、**目标检测**、**语音识别**等任务。CNN 的核心是通过卷积层对输入图像进行特征提取，每一层卷积都从输入中提取不同层次的特征。

- **第一层卷积**：通常提取低级别特征，如边缘、线条等。
- **中间层卷积**：提取更复杂的特征，如纹理、形状等。
- **深层卷积**：提取高阶语义特征，如物体的整体轮廓或类别。

CNN 中的卷积滤波器权重是通过训练数据学习而来的，不同于传统的手动设计滤波器。每个卷积层会生成一个**特征图**（Feature Map），这些特征图捕捉了输入图像的不同方面。

举例：

- 在图像分类中，CNN 可以通过多个卷积层逐步提取图像中的高层次特征，并最终通过全连接层输出图像的类别。
- 在自动驾驶中，CNN 能够从摄像头获取的图像中检测出路标、行人等重要信息。

### 音频处理
卷积在音频处理和合成中也有广泛的应用，特别是用于设计滤波器和特效。

- **卷积混响（Convolution Reverb）**：将一个录制的环境（如教堂、音乐厅等）的声学特性与输入音频信号进行卷积，可以模拟出该环境下的声音效果。
  
- **频率滤波**：通过卷积滤波器可以提取或抑制某些特定频率的音频信号，这在音频修复、降噪、语音识别等领域十分重要。

举例：

- 在音乐制作中，卷积混响可以使录制的声音具有不同环境的混响效果，从而产生丰富的音质。
- 在语音识别系统中，卷积滤波器可以帮助提取语音中的关键特征，并减少背景噪音的干扰。

### 其他领域
- **时间序列分析**：在经济学、金融市场等领域，卷积可以用于对时间序列数据进行平滑、降噪或提取趋势。
- **雷达信号处理**：卷积用于从复杂的雷达回波信号中提取目标物的信息，如位置、速度等。
- **生物信息学**：在基因组序列的分析中，卷积可以用于寻找特定的模式或特征，如基因序列中的重复序列或特定结构。

---

**总结**

卷积在各种背景下，尤其是滤波器的应用中，是一种强大的数学工具。无论是在图像、音频、信号处理，还是深度学习中，卷积通过局部操作提取数据中的重要特征，并可以根据具体任务设计不同的卷积核或滤波器，以达到去噪、增强、特征提取等目的。



## Operation

卷积操作是深度学习（尤其是卷积神经网络，CNN）中的核心步骤，广泛应用于图像处理、音频信号处理等领域。卷积操作可以用来提取输入信号（如图像、音频）的局部特征。

### Process

#### Kernel 
- 卷积核（Convolutional Kernel 或 Filter）是一个小矩阵，通常大小为 3x3 或 5x5，由可学习的权重组成。
- 卷积操作的目的是通过卷积核与输入进行局部点乘运算，得到输出的特征图。

#### Stride

- 步幅决定了卷积核每次滑动的距离。
  - **步幅为 1**：卷积核每次移动一个像素。
  - **步幅为 2**：卷积核每次移动两个像素。
- 步幅越大，输出特征图的尺寸越小。

#### Padding
- 填充是在输入矩阵的边缘填充额外的像素（**通常为 0**），以保持输出的尺寸不变或减少过多信息丢失。
  - **SAME 填充**：填充使得输入输出尺寸相同。
  - **VALID 填充**：不填充，卷积核只在输入的有效区域滑动。

#### dot product

卷积是将卷积核在输入图像上滑动，并对每个位置进行局部的点积运算：

- 卷积核在输入图像上每移动一次，核内的数值和输入图像对应区域的数值相乘并累加，得到一个数值，放入输出的特征图中。
- 通过重复这个操作，卷积核遍历整个输入图像，生成输出特征图。

### Sample

假设我们有一个 5x5 的输入矩阵和一个 3x3 的卷积核，步幅为 1，填充为 0（VALID padding），卷积过程如下：

**输入矩阵：**
$$
\begin{bmatrix}
1 & 2 & 3 & 0 & 1 \\
0 & 1 & 2 & 3 & 1 \\
1 & 2 & 1 & 0 & 2 \\
0 & 1 & 2 & 1 & 1 \\
2 & 1 & 0 & 2 & 1
\end{bmatrix}
$$
**卷积核：**
$$
\begin{bmatrix}
0 & 1 & 2 \\
1 & 0 & 1 \\
2 & 1 & 0
\end{bmatrix}
$$

#### Calculation

1. 将卷积核放在输入矩阵的左上角，计算其覆盖区域内的点乘：
   $$
   (1\cdot0) + (2\cdot1) + (3\cdot2) + (0\cdot1) + (1\cdot0) + (2\cdot1) + (1\cdot2) + (2\cdot1) + (1\cdot0) = 0 + 2 + 6 + 0 + 0 + 2 + 2 + 2 + 0 = 14
   $$
   将结果 14 放入输出矩阵的相应位置。

2. 卷积核向右移动一个步幅，重复相同操作，直到卷积核遍历完整个输入矩阵。

#### Output

$$
\begin{bmatrix}
14 & 13 & 11 \\
10 & 14 & 16 \\
9  & 10 & 12
\end{bmatrix}
$$

## Concepts

- **局部连接**：每个输出神经元只连接输入的一小部分，减少参数和计算量。
- **权重共享**：同一个卷积核在整个输入上滑动，提取共享的特征，这大大减少了模型的参数数量。
- **平移不变性**：卷积操作能够捕捉到相同的特征在不同位置的存在，从而具有平移不变性。







1. **一维卷积公式：**

$$
y(t) = (x * h)(t) = \sum_{\tau=-\infty}^{\infty} x(\tau) h(t - \tau)
$$

2. **二维卷积公式：**

$$
y(i, j) = (x * h)(i, j) = \sum_m \sum_n x(i - m, j - n) h(m, n)
$$





