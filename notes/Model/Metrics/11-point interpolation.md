11点插值法

**11-point interpolation** 是一种常用于计算 **Average Precision (AP)** 的方法，特别是在目标检测任务中，用于在 [[Precision-Recall Curve (PR Curve)]] 上进行插值计算。这种方法通过在召回率的 11 个固定点上计算精度，并取其平均值来得到 [[Average Precision(AP)]]。它的主要目的是消除 PR 曲线的波动性，给出一个更平滑、更稳定的精度评估。

### **11-point interpolation 的步骤**

1. **计算 Precision-Recall 曲线**：
    - 通过遍历模型输出的预测结果（按置信度排序），计算每个召回率（Recall）对应的精度（Precision）。召回率是不断变化的，而精度也随着召回率的增加而发生变化。
2. **定义 11 个召回率点**：
    - 11-point interpolation 方法将召回率从 0 到 1 划分为 11 个固定的点，分别为： $\text{Recall} = \{0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0\}$ 这些点是预先设定好的，用于计算精度值。
3. **在每个召回率点插值**：
    - 对于每个召回率点 $R_i \in \{0, 0.1, 0.2, ..., 1.0\}$，计算对应的精度 $P(R_i)$。具体来说，**插值** 的方式是从 **Precision-Recall 曲线** 中获取对应的精度值：
        - 如果 Precision-Recall 曲线在某个召回率点 $R_i$ 上有数据，直接取该点的精度。
        - 如果 Precision-Recall 曲线在某个召回率点 $R_i$ 上没有数据，则选择 Precision-Recall 曲线上所有大于 $R_i$ 的召回率点中的最大精度值（即精度的“最坏”情况）。
    这种插值方法确保了 PR 曲线上的精度是单调递减的，防止在曲线中出现不自然的波动。
    
4. **计算 AP**：
    - 最后，**Average Precision (AP)** 通过对这 11 个召回率点上对应的精度值进行平均计算： $AP = \frac{1}{11} \sum_{i=0}^{10} P(R_i)$ 其中 $P(R_i)$ 是在召回率点 RiR_i 上的精度值。

### **11-point interpolation 的例子**
假设我们有一个目标检测模型，其 Precision-Recall 曲线（Precision 对应 Recall）如下表所示：

|Recall|Precision|
|---|---|
|0.0|0.9|
|0.1|0.8|
|0.2|0.85|
|0.3|0.7|
|0.4|0.75|
|0.5|0.65|
|0.6|0.7|
|0.7|0.6|
|0.8|0.55|
|0.9|0.5|
|1.0|0.45|

根据 **11-point interpolation** 的规则，我们会从上述曲线中插值并计算在每个召回率点对应的最大精度值。比如：
- 在 Recall = 0.0 时，精度是 0.9。
- 在 Recall = 0.1 时，精度是 0.8。
- 在 Recall = 0.2 时，精度是 0.85。
- 在 Recall = 0.3 时，精度是 0.75（因为精度在 0.3 到 0.5 之间波动，我们取最大的精度 0.75）。
这样我们可以得到如下的精度值列表：

|Recall|Precision|
|---|---|
|0.0|0.9|
|0.1|0.8|
|0.2|0.85|
|0.3|0.75|
|0.4|0.75|
|0.5|0.7|
|0.6|0.7|
|0.7|0.7|
|0.8|0.7|
|0.9|0.7|
|1.0|0.7|

最后，我们计算 **AP**，即将这些精度值求平均：

$$AP = \frac{1}{11} (0.9 + 0.8 + 0.85 + 0.75 + 0.75 + 0.7 + 0.7 + 0.7 + 0.7 + 0.7 + 0.7) = 0.75$$

### **为什么使用 11-point interpolation？**

11-point interpolation 的优点是：
- 它简化了 Precision-Recall 曲线的计算，通过固定的 11 个点来代表不同召回率下的精度表现，避免了曲线上的波动，计算更加稳定。
- 在早期的目标检测任务中，11-point interpolation 已经被标准化并广泛应用，因此它被视为一个比较传统且具有可比性的 AP 计算方法。

### **总结**
**11-point interpolation** 是计算 **Average Precision (AP)** 的一种方法，通过在固定的 11 个召回率点上对精度进行插值计算，得出一个平滑的 AP 值。这种方法在目标检测任务中非常常见，它通过对 Precision-Recall 曲线上的精度值进行平均来评估模型的性能。