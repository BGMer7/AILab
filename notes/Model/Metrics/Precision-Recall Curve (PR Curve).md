

**PR 曲线**（Precision-Recall Curve）是用于评估分类模型性能的图形工具，尤其在 **二分类问题**中，能够直观展示模型在不同 **召回率**（Recall）下的 **精度**（Precision）。PR 曲线特别适用于 **类别不平衡** 的问题，即当正负类样本比例差异较大时，PR 曲线比 ROC 曲线更能准确反映模型的表现。

### **1. Precision 和 Recall**

在解释 PR 曲线之前，我们先了解两个关键指标：

- **Precision（精度）**：表示模型预测为正类的样本中，实际为正类的比例。
    $\text{Precision} = \frac{TP}{TP + FP}$
    其中，TP（True Positive）为真阳性，FP（False Positive）为假阳性。
    
- **Recall（召回率）**：表示实际为正类的样本中，被模型正确预测为正类的比例。
	$\text{Recall} = \frac{TP}{TP + FN}$
    其中，TP（True Positive）为真阳性，FN（False Negative）为假阴性。
    

PR 曲线展示了 **Precision** 和 **Recall** 之间的关系，在不同的 **分类阈值** 下，模型的 **Precision** 和 **Recall** 会发生变化。

### **2. PR 曲线的绘制**

PR 曲线通过在不同的分类 **阈值** 下，计算模型的 **Precision** 和 **Recall** 值并绘制成曲线。分类阈值是模型输出的概率值，用于决定一个样本被分类为正类（通常大于阈值）还是负类（小于阈值）。随着阈值的变化，Precision 和 Recall 也会发生变化，因此绘制出不同阈值下的 Precision-Recall 曲线。

#### 2.1 阈值的影响

- **较低的阈值**：当模型输出的概率较低时，更多的样本会被预测为正类。这会导致 **Recall** 增加，因为更多的正类样本被正确分类，但可能会导致 **Precision** 降低，因为更多的负类样本也会被误分类为正类。
- **较高的阈值**：当模型输出的概率较高时，只有那些高置信度的样本会被预测为正类。这会导致 **Precision** 增加，因为误分类为正类的负类样本减少，但可能会导致 **Recall** 降低，因为一些正类样本可能没有被正确预测为正类。

通过在多个不同阈值下计算 **Precision** 和 **Recall**，可以得到一条 **Precision-Recall 曲线**。

### **3. PR 曲线的形状**

- **理想情况**：理想的 PR 曲线应该在 **Recall** 非常高的情况下，仍能保持 **Precision** 的较高水平。PR 曲线会接近左上角，这表示模型能够高效地识别正类，同时又不会引入过多的假阳性。
- **随机模型**：如果模型的预测结果与随机猜测无异，那么 **Precision** 和 **Recall** 都会处于较低水平，PR 曲线接近对角线（Precision = Recall）。
- **劣质模型**：对于一个表现不好的模型，PR 曲线可能会较为平坦，表示模型的 Precision 和 Recall 都很低。

### **4. PR 曲线与 AUC 的关系**

在 **PR 曲线** 中，我们可以计算 **AUC-PR**（PR 曲线下的面积），类似于 ROC 曲线中的 **AUC**。AUC-PR 衡量的是 **Precision** 和 **Recall** 曲线下的面积，通常来说，AUC-PR 的值越大，模型的性能越好。

- **AUC-PR = 1**：表示模型完美地将正类与负类分开。
- **AUC-PR = 0.5**：表示模型的表现相当于随机猜测。
- **AUC-PR < 0.5**：表示模型的预测结果较差。

### **5. PR 曲线的优缺点**
#### 5.1 **优点**
- **适用于不平衡数据集**：在类别不平衡的情况下，PR 曲线比 ROC 曲线更能准确反映模型性能。因为在不平衡的数据集里，负类样本通常远多于正类样本，ROC 曲线可能会误导评价，而 PR 曲线则能够更专注于正类。
- **关注正类**：PR 曲线主要关注模型对 **正类** 的预测能力，在需要高精度或高召回率的应用中更为合适，例如疾病诊断、垃圾邮件分类等。

#### 5.2 **缺点**
- **忽略了负类**：PR 曲线关注的是正类的预测能力，忽略了负类的性能，因此在某些场景下可能无法提供足够的信息，尤其是当负类样本也很重要时（如某些多分类问题）。

### **6. PR 曲线示例**

假设你训练了一个二分类模型，预测概率如下：

|实际标签|预测概率|
|---|---|
|1|0.9|
|1|0.8|
|0|0.7|
|1|0.6|
|0|0.5|
|0|0.4|
|1|0.3|
|0|0.2|

你可以通过以下步骤计算并绘制 PR 曲线：

1. **计算不同阈值下的 Precision 和 Recall**：
    
    - 选择不同的阈值（例如，0.1, 0.2, 0.3, ..., 0.9）；
    - 对每个阈值计算模型的 **Precision** 和 **Recall**。
2. **绘制 PR 曲线**：
    
    - 使用横轴为 **Recall**，纵轴为 **Precision**，绘制所有阈值下的 (Recall, Precision) 点。
3. **计算 AUC-PR**：
    
    - 计算 PR 曲线下的面积（AUC-PR）来评估模型的性能。

### **7. PR 曲线的应用场景**

- **不平衡数据集**：PR 曲线在正负类样本严重不平衡的情况下非常有效。例如，疾病检测中正类样本（患病的患者）可能远少于负类样本（健康的患者）。
- **需要高精度或高召回率的任务**：在某些任务中，过多的假阳性或假阴性可能带来较大的损失，因此 PR 曲线能够帮助评估模型的 **Precision** 和 **Recall**，以平衡这两者。

### **总结**

**PR 曲线**（Precision-Recall Curve）是评估分类模型性能的工具，尤其适用于 **类别不平衡** 的问题。它展示了模型在不同 **召回率** 下的 **精度**，并通过计算 **AUC-PR** 来评估模型的整体表现。PR 曲线通常比 ROC 曲线在某些任务中更能准确反映模型的性能，尤其是当正类样本比负类样本稀缺时。