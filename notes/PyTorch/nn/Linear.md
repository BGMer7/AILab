åœ¨ PyTorch ä¸­ï¼Œ`nn.Linear` æ˜¯ä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œå®ƒåŒ…å«å¯å­¦ä¹ çš„æƒé‡ï¼ˆ`weight`ï¼‰å’Œåç½®ï¼ˆ`bias`ï¼‰ã€‚å¦‚æœä½ æƒ³æŸ¥çœ‹ä¸€ä¸ª `nn.Linear` å±‚çš„æƒé‡ç³»æ•°ï¼Œå¯ä»¥é€šè¿‡è®¿é—®å…¶ `weight` å±æ€§æ¥å®ç°ã€‚

# ç¤ºä¾‹ä»£ç 
ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•å®šä¹‰ä¸€ä¸ª `nn.Linear` å±‚å¹¶æŸ¥çœ‹å…¶æƒé‡å’Œåç½®ï¼š

```python
import torch
import torch.nn as nn

# å®šä¹‰ä¸€ä¸ªå…¨è¿æ¥å±‚
fc = nn.Linear(10, 5)  # è¾“å…¥ç‰¹å¾ç»´åº¦ä¸º 10ï¼Œè¾“å‡ºç»´åº¦ä¸º 5

# æŸ¥çœ‹æƒé‡
print("Weights shape:", fc.weight.shape)
print("Weights:", fc.weight)

# æŸ¥çœ‹åç½®
print("Bias shape:", fc.bias.shape)
print("Bias:", fc.bias)
```

# è¾“å‡ºç¤ºä¾‹
å‡è®¾æƒé‡å’Œåç½®å·²ç»åˆå§‹åŒ–ï¼Œè¾“å‡ºå¯èƒ½å¦‚ä¸‹ï¼š
```plaintext
Weights shape: torch.Size([5, 10])
Weights: tensor([[ 0.1234, -0.5678,  0.9012, -0.3456,  0.7890, -0.1111,  0.2222, -0.3333,  0.4444, -0.5555],
                 [ 0.6666, -0.7777,  0.8888, -0.9999,  0.1111, -0.2222,  0.3333, -0.4444,  0.5555, -0.6666],
                 [ 0.7777, -0.8888,  0.9999, -0.1111,  0.2222, -0.3333,  0.4444, -0.5555,  0.6666, -0.7777],
                 [ 0.8888, -0.9999,  0.1111, -0.2222,  0.3333, -0.4444,  0.5555, -0.6666,  0.7777, -0.8888],
                 [ 0.9999, -0.1111,  0.2222, -0.3333,  0.4444, -0.5555,  0.6666, -0.7777,  0.8888, -0.9999]])

Bias shape: torch.Size([5])
Bias: tensor([-0.1234,  0.5678, -0.9012,  0.3456, -0.7890])
```

# å…³é”®ç‚¹è§£é‡Š
1. **æƒé‡ï¼ˆ`weight`ï¼‰**ï¼š
   - å½¢çŠ¶ä¸º `[out_features, in_features]`ï¼Œå³ `[5, 10]`ã€‚
   - æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªè¾“å‡ºç‰¹å¾çš„æƒé‡ã€‚
   - æ¯ä¸€åˆ—å¯¹åº”ä¸€ä¸ªè¾“å…¥ç‰¹å¾çš„æƒé‡ã€‚

2. **åç½®ï¼ˆ`bias`ï¼‰**ï¼š
   - å½¢çŠ¶ä¸º `[out_features]`ï¼Œå³ `[5]`ã€‚
   - æ¯ä¸ªåç½®å€¼å¯¹åº”ä¸€ä¸ªè¾“å‡ºç‰¹å¾ã€‚

3. **åˆå§‹åŒ–**ï¼š
   - é»˜è®¤æƒ…å†µä¸‹ï¼Œ`nn.Linear` çš„æƒé‡å’Œåç½®ä¼šè‡ªåŠ¨åˆå§‹åŒ–ã€‚æƒé‡é€šå¸¸ä½¿ç”¨ Kaiming åˆå§‹åŒ–ï¼Œåç½®åˆå§‹åŒ–ä¸º 0ã€‚
   - å¦‚æœéœ€è¦è‡ªå®šä¹‰åˆå§‹åŒ–ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ï¼š
     ```python
     nn.init.xavier_uniform_(fc.weight)
     nn.init.constant_(fc.bias, 0.1)
     ```

# æ€»ç»“
é€šè¿‡è®¿é—® `fc.weight` å’Œ `fc.bias`ï¼Œä½ å¯ä»¥æŸ¥çœ‹ `nn.Linear` å±‚çš„æƒé‡å’Œåç½®ã€‚è¿™äº›å‚æ•°æ˜¯å¯å­¦ä¹ çš„ï¼Œä¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­é€šè¿‡åå‘ä¼ æ’­è¿›è¡Œæ›´æ–°ã€‚




[[He Initialization]]
**Kaiming åˆå§‹åŒ–ï¼ˆHe åˆå§‹åŒ–ï¼‰**ç¡®å®æ˜¯éšæœºçš„ï¼Œä½†å®ƒæœä»ç‰¹å®šçš„åˆ†å¸ƒï¼Œè¿™äº›åˆ†å¸ƒæ˜¯ç»è¿‡ç²¾å¿ƒè®¾è®¡çš„ï¼Œä»¥ç¡®ä¿ç½‘ç»œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­èƒ½å¤Ÿæ›´å¥½åœ°ä¼ æ’­ä¿¡å·å¹¶é¿å…æ¢¯åº¦æ¶ˆå¤±æˆ–çˆ†ç‚¸é—®é¢˜ã€‚

### Kaiming åˆå§‹åŒ–çš„éšæœºæ€§
Kaiming åˆå§‹åŒ–çš„æ ¸å¿ƒæ€æƒ³æ˜¯ä¸ºæƒé‡é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„éšæœºåˆ†å¸ƒï¼Œä½¿å¾—ç½‘ç»œçš„è¾“å…¥å’Œè¾“å‡ºåœ¨æ­£å‘ä¼ æ’­å’Œåå‘ä¼ æ’­æ—¶ä¿æŒç¨³å®šçš„æ–¹å·®ã€‚å…·ä½“æ¥è¯´ï¼Œæƒé‡çš„åˆå§‹åŒ–å€¼æ˜¯éšæœºçš„ï¼Œä½†è¿™äº›éšæœºå€¼æœä»ç‰¹å®šçš„åˆ†å¸ƒï¼Œä¾‹å¦‚ï¼š

1. **Kaiming Normalï¼ˆæ­£æ€åˆ†å¸ƒï¼‰**ï¼š
   - æƒé‡ä»å‡å€¼ä¸º 0ã€æ ‡å‡†å·®ä¸º$\sqrt{\frac{2}{\text{fan\_in}}}$ çš„æ­£æ€åˆ†å¸ƒä¸­éšæœºé‡‡æ ·ã€‚
   - å…¬å¼ï¼š  
     $$
     W \sim \mathcal{N}\left(0, \frac{2}{\text{fan\_in}}\right)
     $$
     
   
2. **Kaiming Uniformï¼ˆå‡åŒ€åˆ†å¸ƒï¼‰**ï¼š
   
   - æƒé‡ä»èŒƒå›´ä¸º$\left[-\sqrt{\frac{6}{\text{fan\_in}}}, \sqrt{\frac{6}{\text{fan\_in}}}\right]$çš„å‡åŒ€åˆ†å¸ƒä¸­éšæœºé‡‡æ ·ã€‚
   - å…¬å¼ï¼š 
     $$
     W \sim \mathcal{U}\left(-\sqrt{\frac{6}{\text{fan\_in}}}, \sqrt{\frac{6}{\text{fan\_in}}}\right)
     $$
     

### éšæœºæ€§çš„ä½œç”¨
- **éšæœºåˆå§‹åŒ–**ï¼šéšæœºæ€§ç¡®ä¿äº†æ¯ä¸ªæƒé‡çš„åˆå§‹å€¼æ˜¯ç‹¬ç«‹çš„ï¼Œé¿å…äº†æ‰€æœ‰æƒé‡ç›¸åŒçš„æƒ…å†µã€‚å¦‚æœæ‰€æœ‰æƒé‡åˆå§‹åŒ–ä¸ºç›¸åŒçš„å€¼ï¼Œç½‘ç»œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¯èƒ½ä¼šé™·å…¥å¯¹ç§°æ€§é—®é¢˜ï¼Œå¯¼è‡´æ¢¯åº¦æ›´æ–°å®Œå…¨ä¸€è‡´ï¼Œæ— æ³•å­¦ä¹ åˆ°æœ‰ç”¨çš„ç‰¹å¾ã€‚
- **ç‰¹å®šåˆ†å¸ƒ**ï¼šè™½ç„¶æƒé‡æ˜¯éšæœºçš„ï¼Œä½†å®ƒä»¬æœä»ç‰¹å®šçš„åˆ†å¸ƒï¼Œè¿™äº›åˆ†å¸ƒçš„å‚æ•°ï¼ˆå¦‚æ–¹å·®ï¼‰æ˜¯æ ¹æ®ç½‘ç»œçš„ç»“æ„ï¼ˆå¦‚è¾“å…¥ç¥ç»å…ƒæ•°é‡ $\text{fan\_in}$ï¼‰å’Œæ¿€æ´»å‡½æ•°ï¼ˆå¦‚ ReLUï¼‰ç²¾å¿ƒè®¾è®¡çš„ï¼Œä»¥ç¡®ä¿ç½‘ç»œåœ¨è®­ç»ƒåˆæœŸèƒ½å¤Ÿç¨³å®šåœ°ä¼ æ’­ä¿¡å·ã€‚

### ç¤ºä¾‹ä»£ç 
ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ PyTorch ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ Kaiming åˆå§‹åŒ–ï¼š

```python
import torch
import torch.nn.init as init

# åˆ›å»ºä¸€ä¸ªæƒé‡å¼ é‡
weight = torch.empty(5, 10)  # è¾“å‡ºç»´åº¦ä¸º 5ï¼Œè¾“å…¥ç»´åº¦ä¸º 10

# ä½¿ç”¨ Kaiming Normal åˆå§‹åŒ–
init.kaiming_normal_(weight, mode='fan_in', nonlinearity='relu')
print("Kaiming Normal Initialization:\n", weight)

# åˆ›å»ºå¦ä¸€ä¸ªæƒé‡å¼ é‡
weight_uniform = torch.empty(5, 10)

# ä½¿ç”¨ Kaiming Uniform åˆå§‹åŒ–
init.kaiming_uniform_(weight_uniform, mode='fan_in', nonlinearity='relu')
print("\nKaiming Uniform Initialization:\n", weight_uniform)
```

### è¾“å‡ºç¤ºä¾‹
æ¯æ¬¡è¿è¡Œä»£ç æ—¶ï¼Œæƒé‡çš„å€¼éƒ½ä¼šä¸åŒï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä»éšæœºåˆ†å¸ƒä¸­é‡‡æ ·çš„ã€‚ä¾‹å¦‚ï¼š
```plaintext
Kaiming Normal Initialization:
 tensor([[ 0.3478, -0.2345,  0.1234, ...,  0.4567, -0.5678,  0.6789],
         [-0.7890,  0.8901, -0.9012, ..., -0.1234,  0.2345, -0.3456],
         [ 0.4567, -0.5678,  0.6789, ...,  0.7890, -0.8901,  0.9012],
         [-0.1234,  0.2345, -0.3456, ..., -0.4567,  0.5678, -0.6789],
         [ 0.7890, -0.8901,  0.9012, ..., -0.1234,  0.2345, -0.3456]])

Kaiming Uniform Initialization:
 tensor([[ 0.1234, -0.2345,  0.3456, ...,  0.4567, -0.5678,  0.6789],
         [-0.7890,  0.8901, -0.9012, ..., -0.1234,  0.2345, -0.3456],
         [ 0.4567, -0.5678,  0.6789, ...,  0.7890, -0.8901,  0.9012],
         [-0.1234,  0.2345, -0.3456, ..., -0.4567,  0.5678, -0.6789],
         [ 0.7890, -0.8901,  0.9012, ..., -0.1234,  0.2345, -0.3456]])
```

### æ€»ç»“
Kaiming åˆå§‹åŒ–æ˜¯éšæœºçš„ï¼Œä½†è¿™ç§éšæœºæ€§æ˜¯ç»è¿‡ç²¾å¿ƒè®¾è®¡çš„ï¼Œæƒé‡ä»ç‰¹å®šçš„åˆ†å¸ƒä¸­é‡‡æ ·ï¼Œä»¥ç¡®ä¿ç½‘ç»œåœ¨è®­ç»ƒåˆæœŸèƒ½å¤Ÿç¨³å®šåœ°ä¼ æ’­ä¿¡å·ã€‚è¿™ç§åˆå§‹åŒ–æ–¹æ³•ç‰¹åˆ«é€‚ç”¨äºä½¿ç”¨ ReLU æ¿€æ´»å‡½æ•°çš„æ·±åº¦ç¥ç»ç½‘ç»œï¼Œèƒ½å¤Ÿæœ‰æ•ˆç¼“è§£æ¢¯åº¦æ¶ˆå¤±å’Œçˆ†ç‚¸é—®é¢˜ã€‚




## ğŸ¯ nn.Linear æ ¸å¿ƒæ¦‚å¿µ

### **æ•°å­¦å…¬å¼**

```python
y = xW^T + b
# x: è¾“å…¥ [batch_size, in_features]
# W: æƒé‡çŸ©é˜µ [out_features, in_features]  
# b: åç½®å‘é‡ [out_features]
# y: è¾“å‡º [batch_size, out_features]
```

### **åŸºæœ¬ç”¨æ³•**

```python
# åˆ›å»ºçº¿æ€§å±‚ï¼šè¾“å…¥3ç»´ï¼Œè¾“å‡º5ç»´
linear = nn.Linear(in_features=3, out_features=5)

# å‰å‘ä¼ æ’­
input_data = torch.randn(2, 3)  # 2ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ª3ç»´
output = linear(input_data)     # è¾“å‡º: [2, 5]
```

## ğŸ” å…³é”®ç‰¹ç‚¹

### 1. **åªå¯¹æœ€åä¸€ç»´å˜æ¢**

- è¾“å…¥ `[batch, seq, features]` â†’ è¾“å‡º `[batch, seq, new_features]`
- å‰é¢çš„ç»´åº¦ä¿æŒä¸å˜

### 2. **å‚æ•°é‡è®¡ç®—**

```python
å‚æ•°é‡ = in_features Ã— out_features + out_features
      = (æƒé‡å‚æ•°)        + (åç½®å‚æ•°)
```

### 3. **å¸¸è§åº”ç”¨åœºæ™¯**

- **åˆ†ç±»å™¨**ï¼šæœ€åä¸€å±‚è¾“å‡ºç±»åˆ«æ•°
- **ç‰¹å¾å˜æ¢**ï¼šæ”¹å˜ç‰¹å¾ç»´åº¦
- **Transformer**ï¼šQã€Kã€Vå˜æ¢å’Œå‰é¦ˆç½‘ç»œ
- **MLP**ï¼šå¤šå±‚æ„ŸçŸ¥æœºçš„åŸºç¡€ç»„ä»¶

## ğŸ’¡ å®ç”¨æŠ€å·§

### **ç»´åº¦é€‰æ‹©**

- å¸¸ç”¨ç»´åº¦ï¼š64, 128, 256, 512, 768, 1024
- é€šå¸¸æ˜¯2çš„å¹‚æ¬¡ï¼Œä¾¿äºç¡¬ä»¶ä¼˜åŒ–

### **å‚æ•°åˆå§‹åŒ–**

- é»˜è®¤ï¼šKaimingåˆå§‹åŒ–ï¼ˆé€‚åˆReLUï¼‰
- Xavierï¼šé€‚åˆSigmoid/Tanh
- å¯ä»¥è‡ªå®šä¹‰åˆå§‹åŒ–æ–¹å¼

### **è°ƒè¯•æŠ€å·§**

```python
print(f"æƒé‡å½¢çŠ¶: {linear.weight.shape}")
print(f"åç½®å½¢çŠ¶: {linear.bias.shape}")
print(f"å‚æ•°é‡: {sum(p.numel() for p in linear.parameters())}")
```

è¿è¡Œè¿™ä¸ªæ•™ç¨‹ä»£ç ï¼Œä½ ä¼šçœ‹åˆ°ä»åŸºç¡€ç”¨æ³•åˆ°é«˜çº§åº”ç”¨çš„å®Œæ•´ç¤ºä¾‹ï¼ŒåŒ…æ‹¬åœ¨Transformerä¸­çš„å®é™…ä½¿ç”¨æ–¹å¼ï¼